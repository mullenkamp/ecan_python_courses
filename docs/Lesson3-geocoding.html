

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-88382509-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Geocoding &mdash; GeoPython - AutoGIS 1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="GeoPython - AutoGIS 1 documentation" href="index.html"/>
        <link rel="next" title="Table join" href="Lesson3-table-join.html"/>
        <link rel="prev" title="Lesson 3 Overview" href="Lesson3-overview.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> GeoPython - AutoGIS
          

          
            
            <img src="_static/logo_hy_geo_135.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                2016 Autumn
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="course-info.html">General info</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installing_Anacondas_GIS.html">Installing Python + GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="License-terms.html">License and terms of usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Lesson1-Intro-Python-GIS.html">Introduction to Python GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson1-Geometric-Objects.html">Geometric Objects - Spatial Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exercise-1.html">Exercise 1</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Lesson2-overview.html">Lesson 2 Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson2-download-data.html">Download datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson2-overview-pandas-geopandas.html">Pandas and Geopandas -modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson2-pandas-intro.html">Introduction to Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson2-geopandas-basics.html">Introduction to Geopandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exercise-2.html">Exercise 2</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 3</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Lesson3-overview.html">Lesson 3 Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Geocoding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview-of-geocoders">Overview of Geocoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="#geocoding-in-geopandas">Geocoding in Geopandas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Lesson3-table-join.html">Table join</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson3-projections.html">Re-projecting data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson3-point-in-polygon.html">Point in Polygon &amp; Intersect</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson3-spatial-join.html">Spatial join</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exercise-3.html">Exercise 3</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 4</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Lesson4-overview.html">Lesson 4 Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson4-download-data.html">Download datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson4-geometric-operations.html">Geometric operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson4-reclassify.html">Data reclassification</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson4-nearest-neighbour.html">Nearest Neighbour Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exercise-4.html">Exercise 4</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 5</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Lesson5-overview.html">Lesson 5 Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson5-download-data.html">Download datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson5-static-maps.html">Static maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson5-interactive-map-bokeh.html">Interactive maps with Bokeh</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson5-share-on-github.html">Sharing interactive plots on GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson5-interactive-map-folium.html">Interactive maps on Leaflet</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson5-World-3D.html">Inspiration: World 3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exercise-5.html">Exercise 5</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 6</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Lesson6-overview.html">Lesson 6 Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson6-arcpy.html">Python in ArcGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson6-toolbox.html">ArcGIS Toolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson6-arcpy-script.html">Writing arcpy scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson6-run-the-tool.html">Running the Python script from ArcGIS</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 7</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Lesson7-overview.html">Lesson 7 Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson7-download.html">Download data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson7-read-raster.html">Reading raster files with GDAL</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson7-read-raster-array.html">Reading raster as a numerical array</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lesson7-gdal-utilities.html">GDAL command line tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exercise-7.html">Exercise 7</a></li>
</ul>
<p class="caption"><span class="caption-text">Lesson 8</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Lesson8-network-analysis.html">Network analysis in Python</a></li>
</ul>
<p class="caption"><span class="caption-text">Final Assignment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Final-assignment.html">Final assignment</a></li>
</ul>
<p class="caption"><span class="caption-text">Map Challenge 2016</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="map-challenge.html">Map Challenge 2016</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">GeoPython - AutoGIS</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Geocoding</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/Automating-GIS-processes/2016/blob/master/source/Lesson3-geocoding.rst" class="fa fa-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="geocoding">
<h1>Geocoding<a class="headerlink" href="#geocoding" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview-of-geocoders">
<h2>Overview of Geocoders<a class="headerlink" href="#overview-of-geocoders" title="Permalink to this headline">¶</a></h2>
<p>Geocoding, i.e. converting addresses into coordinates or vice versa, is
a really common GIS task. Luckily, in Python there are nice libraries
that makes the geocoding really easy. One of the libraries that can do
the geocoding for us is
<a class="reference external" href="http://geopy.readthedocs.io/en/1.11.0/">geopy</a> that makes it easy to
locate the coordinates of addresses, cities, countries, and landmarks
across the globe using third-party geocoders and other data sources.</p>
<p>As said, <strong>Geopy</strong> uses third-party geocoders - i.e. services that does
the geocoding - to locate the addresses and it works with multiple
different service providers such as:</p>
<ul class="simple">
<li><a class="reference external" href="http://resources.arcgis.com/en/help/arcgis-rest-api/">ESRI
ArcGIS</a></li>
<li><a class="reference external" href="http://developer.baidu.com/map/webservice-geocoding.htm">Baidu
Maps</a></li>
<li><a class="reference external" href="http://www.microsoft.com/maps/developers/web.aspx">Bing</a></li>
<li><a class="reference external" href="http://geocoder.us/">geocoder.us</a></li>
<li><a class="reference external" href="https://www.geocodefarm.com/">GeocodeFarm</a></li>
<li><a class="reference external" href="http://www.geonames.org/">GeoNames</a></li>
<li><a class="reference external" href="https://developers.google.com/maps/documentation/geocoding/">Google Geocoding API
(V3)</a></li>
<li><a class="reference external" href="http://api.ign.fr/tech-docs-js/fr/developpeur/search.html">IGN
France</a></li>
<li><a class="reference external" href="http://www.mapquestapi.com/geocoding/">Mapquest</a></li>
<li><a class="reference external" href="https://mapzen.com/projects/search/">Mapzen Search</a></li>
<li><a class="reference external" href="http://navidata.pl">NaviData</a></li>
<li><a class="reference external" href="http://geocoder.opencagedata.com/api.html">OpenCage</a></li>
<li><a class="reference external" href="http://developer.mapquest.com/web/products/open/geocoding-service">OpenMapQuest</a></li>
<li><a class="reference external" href="https://wiki.openstreetmap.org/wiki/Nominatim">Open Street Map
Nominatim</a></li>
<li><a class="reference external" href="https://smartystreets.com/products/liveaddress-api">SmartyStreets</a></li>
<li><a class="reference external" href="http://what3words.com/api/reference">What3words</a></li>
<li><a class="reference external" href="http://api.yandex.com/maps/doc/intro/concepts/intro.xml">Yandex</a></li>
</ul>
<p>Thus, there is plenty of geocoders where to choose from! However, to be
able to use these services you might need to request so called API
access-keys from the service provider to be able to use the service. You
can get your access keys to e.g. Google Geocoding API from <a class="reference external" href="https://code.google.com/apis/console">Google APIs
console</a> by creating a Project
and enabling a that API from
<a class="reference external" href="https://console.developers.google.com/apis/library">Library</a>. Read a
short introduction about using Google API Console from
<a class="reference external" href="https://developers.googleblog.com/2016/03/introducing-google-api-console.html">here</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There are also other Python modules in addition to geopy that can do
geocoding such as <a class="reference external" href="http://geocoder.readthedocs.io/">Geocoder</a>.</p>
</div>
</div>
<div class="section" id="geocoding-in-geopandas">
<h2>Geocoding in Geopandas<a class="headerlink" href="#geocoding-in-geopandas" title="Permalink to this headline">¶</a></h2>
<p>It is possible to do geocoding in Geopandas using its integrated
functionalities of geopy. Geopandas has a function called <code class="docutils literal"><span class="pre">geocode()</span></code>
that can geocode a list of addresses (strings) and return a GeoDataFrame
containing the resulting point objects in <code class="docutils literal"><span class="pre">geometry</span></code> column. Nice,
isn&#8217;t it! Let&#8217;s try this out.</p>
<p>Download a text file called <a class="reference external" href="https://raw.githubusercontent.com/Automating-GIS-processes/Lesson-3-Geocoding-Spatial-Queries/master/data/addresses.txt">addresses.txt</a> that
contains few addresses around Helsinki Region. The first rows of the
data looks like following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="nb">id</span><span class="p">;</span><span class="n">address</span>
<span class="mi">1000</span><span class="p">;</span><span class="n">Itämerenkatu</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">00101</span> <span class="n">Helsinki</span><span class="p">,</span> <span class="n">Finland</span>
<span class="mi">1001</span><span class="p">;</span><span class="n">Kampinkuja</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">00100</span> <span class="n">Helsinki</span><span class="p">,</span> <span class="n">Finland</span>
<span class="mi">1002</span><span class="p">;</span><span class="n">Kaivokatu</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">00101</span> <span class="n">Helsinki</span><span class="p">,</span> <span class="n">Finland</span>
<span class="mi">1003</span><span class="p">;</span><span class="n">Hermanstads</span> <span class="n">strandsväg</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">00580</span> <span class="n">Helsingfors</span><span class="p">,</span> <span class="n">Finland</span>
</pre></div>
</div>
<ul class="simple">
<li>Let&#8217;s first read the data into a Pandas DataFrame using
<code class="docutils literal"><span class="pre">read_csv()</span></code> -function:</li>
</ul>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Import necessary modules</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="k">import</span> <span class="n">Point</span>

<span class="c1"># Filepath</span>
<span class="n">fp</span> <span class="o">=</span> <span class="s2">r&quot;addresses.txt&quot;</span>

<span class="c1"># Read the data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="go"># Let&#39;s take a look of the data</span>
<span class="gp">In [1]: </span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[1]: </span><span class="go"></span>
<span class="go">     id                                            address</span>
<span class="go">0  1000           Itämerenkatu 14, 00101 Helsinki, Finland</span>
<span class="go">1  1001              Kampinkuja 1, 00100 Helsinki, Finland</span>
<span class="go">2  1002               Kaivokatu 8, 00101 Helsinki, Finland</span>
<span class="go">3  1003  Hermanstads strandsväg 1, 00580 Helsingfors, F...</span>
<span class="go">4  1004                  Itäväylä, 00900 Helsinki, Finland</span>
</pre></div>
</div>
<ul class="simple">
<li>Now we have our data in a Pandas DataFrame and we can geocode our
addresses</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Here we use my API key that has a limitation of 2500 requests / hour. Because of this, only the computer instances of our course environment have access to Google Geocoding API for a short period of time. Thus, the following key will NOT work from your own computer, only from our cloud computers. If you wish, you can create your own API key to Google Geocoding API V3 from <a class="reference external" href="https://code.google.com/apis/console">Google APIs console</a>. See the notes from <a class="reference external" href="Lesson3-geocoding.html#overview-of-geocoders">above</a>.</p>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="go"># Import the geocoding tool</span>
<span class="gp">In [2]: </span><span class="kn">from</span> <span class="nn">geopandas.tools</span> <span class="kn">import</span> <span class="n">geocode</span>

<span class="go"># Key for our Google Geocoding API</span>
<span class="go"># Notice: only the cloud computers of our course can access and</span>
<span class="go"># successfully execute the following</span>
<span class="gp">In [3]: </span><span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;AIzaSyAwNVHAtkbKlPs-EEs3OYqbnxzaYfDF2_8&#39;</span>

<span class="go"># Geocode addresses</span>
<span class="gp">In [4]: </span><span class="n">geo</span> <span class="o">=</span> <span class="n">geocode</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;address&#39;</span><span class="p">],</span> <span class="n">api_key</span><span class="o">=</span><span class="n">key</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">geo</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gh">Out[5]: </span><span class="go"></span>
<span class="go">                                    address                       geometry</span>
<span class="go">0  Itämerenkatu 14, 00180 Helsinki, Finland  POINT (24.9146767 60.1628658)</span>
<span class="go">1     Kampinkuja 1, 00100 Helsinki, Finland  POINT (24.9301701 60.1683731)</span>
</pre></div>
</div>
<p>And Voilà! As a result we have a GeoDataFrame that contains our original
address and a &#8216;geometry&#8217; column containing Shapely Point -objects that
we can use for exporting the addresses to a Shapefile for example.
However, the <code class="docutils literal"><span class="pre">id</span></code> column is not there. Thus, we need to join the
information from <code class="docutils literal"><span class="pre">data</span></code> into our new GeoDataFrame <code class="docutils literal"><span class="pre">geo</span></code>, thus making
a <strong>Table Join</strong>.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Lesson3-table-join.html" class="btn btn-neutral float-right" title="Table join" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Lesson3-overview.html" class="btn btn-neutral" title="Lesson 3 Overview" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Henrikki Tenkanen.
      Last updated on Feb 20, 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
    <li><a href="http://project.invalid/">Project Homepage</a> &raquo;</li>

    <div class="footer">
        <img src="../img/GPLv3_Logo.svg">
    </div>
     



</body>
</html>